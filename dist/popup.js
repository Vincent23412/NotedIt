(()=>{"use strict";function e(e){return new Promise((t=>{chrome.storage.local.get(e,(n=>{t(n[e])}))}))}var t=function(e,t,n,o){return new(n||(n=Promise))((function(l,c){function i(e){try{d(o.next(e))}catch(e){c(e)}}function r(e){try{d(o.throw(e))}catch(e){c(e)}}function d(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}d((o=o.apply(e,t||[])).next())}))};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("note-list"),t=document.getElementById("note"),l=document.getElementById("save-button");n(e,t),l.addEventListener("click",o(e,t))}));const n=(n,o)=>t(void 0,void 0,void 0,(function*(){const t=(yield e("notes"))||[];n.innerHTML="";const o=function(e){const t={};for(const n of e){const e=n.hostname;t[e]||(t[e]=[]),t[e].push(n)}return t}(t);console.log("åˆ†çµ„å¾Œçš„ç­†è¨˜ï¼š",o),t.forEach((e=>{l(e,n)}))})),o=(o,l)=>()=>t(void 0,void 0,void 0,(function*(){var t,c,i;const r=l.value;if(!r)return;const[d,s]=yield Promise.all([e("notes"),chrome.tabs.query({active:!0,currentWindow:!0})]),a=(null===(t=s[0])||void 0===t?void 0:t.url)||"unknown",u=(null===(c=s[0])||void 0===c?void 0:c.favIconUrl)||"",m=d||[],v={title:(null===(i=s[0])||void 0===i?void 0:i.title)||"unknown",content:r,url:a,iconUrl:u,hostname:"unknown"!==a?new URL(a).hostname:"unknown",createdAt:Date.now()};var p;m.push(v),yield(p={notes:m},new Promise((e=>{chrome.storage.local.set(p,(()=>{e()}))}))),l.value="",n(o,l)})),l=(e,t)=>{const n=document.createElement("li");n.style.display="flex",n.style.flexDirection="column",n.style.marginBottom="10px",n.style.padding="6px",n.style.borderBottom="1px solid #ddd";const o=document.createElement("img");o.src=e.iconUrl||"icons/default-icon.png",o.alt="icon",o.width=16,o.height=16,o.style.marginRight="4px";const l=document.createElement("div");l.style.display="flex",l.style.alignItems="center",l.style.gap="4px";const c=document.createElement("span");c.textContent=e.content,l.appendChild(o),l.appendChild(c);const i=document.createElement("a");i.href=e.url,i.textContent=`ðŸ”— ${e.url}`,i.target="_blank",i.style.fontSize="0.85em",i.style.color="#0066cc",i.style.textDecoration="underline",i.style.wordBreak="break-all",n.appendChild(l),n.appendChild(i),t.appendChild(n)}})();